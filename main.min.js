var Space=function(A){"use strict";let t=/^[A-Za-z0-9\+\-;'\\\[\]]$/,e=/^(\s|Shift|ArrowUp|ArrowDown|ArrowLeft|ArrowRight|Backspace|Enter|Tab|\*)$/,s=/^(\!|\$)$/;function r(A){return A.match(t)||A.match(e)||A.match(s)}class i{get left(){return this.btn("left")}get right(){return this.btn("right")}_btn=new Map;press=(A,t)=>{let e=t.ctrlKey,s=t.shiftKey;this._btn.has(A)?this._btn.get(A).just_pressed=!0:this._btn.set(A,{just_pressed:!0,just_released:!1,ctrl:e,shift:s,t:0,t0:0})};release=A=>{let t=this._btn.get(A);t&&(t.just_released=!0)};btn=(A,t,e)=>{let s=this._btn.get(A);return s&&!!t==!!s.shift?s.t:0};btn0=(A,t,e)=>{let s=this._btn.get(A);return s&&!!t==!!s.shift?s.t0:0};btnp=(A,t,e)=>this.btn(A,t,e)>0&&0===this.btn0(A,t,e);btnpp=A=>this._btnpp===A;update=(A,t)=>{this._btnpp=void 0;for(let[t,e]of this._btn)0===e.t&&(e.t0=e.t),(e.just_pressed||e.t>0)&&(e.t0=e.t,e.t+=A,e.just_pressed=!1),e.just_released&&(e.t0=e.t,e.t=0,e.just_released=!1,this._last_released&&this._last_released===t?(this._btnpp=t,this._last_released=void 0):this._last_released=t)};init(){let{press:A,release:t}=this;return document.addEventListener("keydown",(t=>{if(!t.ctrlKey&&r(t.key))switch(t.preventDefault(),t.key){case"ArrowUp":A("up",t);break;case"ArrowDown":A("down",t);break;case"ArrowLeft":A("left",t);break;case"ArrowRight":A("right",t);break;default:A(t.key,t)}})),document.addEventListener("keyup",(A=>{if(!A.ctrlKey&&r(A.key))switch(A.preventDefault(),A.key){case"ArrowUp":t("up");break;case"ArrowDown":t("down");break;case"ArrowLeft":t("left");break;case"ArrowRight":t("right");break;default:t(A.key)}})),this}}class a{_wheel=0;_wheel0=0;get bounds(){return this._bounds||(this._bounds=this.$canvas.getBoundingClientRect()),this._bounds}get wheel(){return this._wheel}get drag(){if(this._drag?.move)return this._drag}get click(){if(!this._drag?.move&&this._drag?.drop)return this._drag.drop}get drag_delta(){if(this._drag?.move)return[this._drag.move[0]-this._drag.start[0],this._drag.move[1]-this._drag.start[1]]}constructor(A){this.$canvas=A}eventPosition(A){let t=function(A){return void 0!==A.clientX&&void 0!==A.clientY?[A.clientX,A.clientY]:A.targetTouches?.[0]?[A.targetTouches[0].clientX,A.targetTouches[0].clientY]:void 0}(A),{bounds:e}=this,s=1920/e.width,r=1080/e.height;return t&&(t[0]-=e.left,t[1]-=e.top,t[0]*=s,t[1]*=r),t}disposes=[];dispose(){this.disposes.forEach((A=>A()))}init(){let{$canvas:A,disposes:t}=this;A.addEventListener("wheel",(A=>{this._wheel=Math.sign(A.deltaY)})),A.addEventListener("mousedown",(A=>{this._drag||(this._drag={button:A.button,start:this.eventPosition(A)})})),A.addEventListener("mousemove",(A=>{this._drag&&(this._drag.r_move=this.eventPosition(A))}));let e=A=>{this._drag&&(this._drag.drop=this.eventPosition(A),this._drop0=this._drag)};document.addEventListener("mouseup",e),t.push((()=>document.removeEventListener("mouseup",e)));const s=()=>{this._bounds=void 0};return window.addEventListener("resize",s),document.addEventListener("scroll",s),t.push((()=>window.removeEventListener("resize",s))),t.push((()=>document.removeEventListener("scroll",s))),this}update(A,t){this._wheel0===this._wheel?this._wheel=0:this._wheel0=this._wheel,this._drag&&(this._drag.move0=this._drag.move,void 0!==this._drag.r_move&&(this._drag.move||function(A,t){let e=A[0]-t[0],s=A[1]-t[1];return Math.sqrt(e*e+s*s)>30}(this._drag.r_move,this._drag.start))&&(this._drag.move=this._drag.r_move),this._drop0?this._drop0=void 0:this._drag.drop&&(this._drag=void 0))}}const n=[0,1,2,3,4,5,6],h=new A.Transform;class o{quads=[];frame=0;get quad(){return this.quads[this.frame]||(this.quads[this.frame]=A.Quad.make(this.image,this.x+this.w*this.frame,this.y,this.w,this.h)),this.quads[this.frame]}get template(){let t=h.clone;return t.quad=this.quad,t.size=A.Vec2.make(this.w,this.h),t}constructor(A,t,e,s,r){this.image=A,this.x=t,this.y=e,this.w=s,this.h=r}}class d extends class{get mouse(){return this.ctx.mouse}get input(){return this.ctx.input}get image(){return this.ctx.image}get root(){return this.ctx.root}anim(A,t,e,s){return new o(this.image,A,t,e,s)}constructor(A){this.ctx=A}_set_data(A){return this.data=A,this}init(){return this.life=0,this.life0=0,this._init(),this}update(A,t){this.life0=this.life,this.life+=A,this._update(A,t)}on_interval(A){return Math.floor(this.life0/A)!==Math.floor(this.life/v)}}{get x(){return this.container.x}get y(){return this.container.y}set x(A){this.container.x=A}set y(A){this.container.y=A}set scale(A){this.container.scale.set_in(A)}get scale(){return this.container.scale.x}constructor(A,t){super(A),this.parent=t}add_after_init(){this.container._set_parent(this.parent),this.on_attached()}remove(){this.container._remove(),this.on_removed()}on_attached(){}on_removed(){}}class u extends d{get clone(){return new this.constructor(this.ctx,this.parent,this.plays)._set_data(this.data).init(),this}get colors(){return this.plays.colors}constructor(A,t=A.container){super(A.ctx,t),this.plays=A}}class g{constructor(A){this.colors=n.map((t=>new o(A,0,2*t,2,2)))}quad(A,t){let e=this.colors[A];return e.frame=t,e.quad}}const c=new A.Transform;class l extends u{_init(){this.container=c.clone}_update(A,t){}}class w extends d{colors=new g(this.image);get config(){return this.data}_init(){this.container=c.clone,this.headsup=new l(this)._set_data({}).init(),this.headsup.add_after_init()}_update(A,t){}}return function(t){var e;(e="data:image/png;base64,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",new Promise((A=>{let t=new Image;t.onload=()=>A(t),t.src=e}))).then((e=>{!function(t,e,s={}){let[r,n,h]=A.Soli2d(e,t,320,180),o=new i,d=new a(h).init(),u=new w({mouse:d,input:o,image:t},n)._set_data(s).init();u.add_after_init(),n._update_world();let g=A.loop(((A,t)=>{d.update(A,t),o.update(A,t),u.update(A,t),n._update_world(),r()}))}(e,t)}))}}(soli2d);
